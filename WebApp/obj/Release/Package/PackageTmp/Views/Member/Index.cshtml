@model WebApp.Models.UserInfoViewModel
@{
    ViewBag.Title = "欢迎来到云联快乐家园";
}

@section css
{
    <style type="text/css">
        .row4 {
            width: 16%;
            margin-top: 10px;
            float: left;
            height: 25px;
            text-align: center;
            font-size: 14px;
        }

        .row5 {
            width: 16%;
            margin-top: 10px;
            float: left;
            height: 25px;
            text-align: center;
            font-size: 12px;
        }

        .row0 {
            color: #3399FF;
            background: #FFF;
            width: 100%;
        }

        .top {
            margin: 55px 10px 0px 10px;
            width: auto;
            height: 80px;
            background: #ff0000;
            text-align: center;
        }

        .small {
            height: 80px;
            width: 80%;
            margin: 50px auto;
            border: #ff0000 solid 1px;
            text-align: center;
        }

        .smallcontent1 {
            text-align: center;
            color: white;
            font-size: 18px;
            font-weight: bold;
            line-height: 22px;
            padding: 0px;
            border: 0px;
            vertical-align: middle;
            margin-top: 15px;
            margin-bottom: 3px;
        }

        .smallcontent2 {
            text-align: center;
            color: white;
            font-size: 22px;
            font-weight: bold;
            padding: 0px;
            border: 0px;
            vertical-align: middle;
            line-height: 22px;
            margin: 0 auto;
        }

        .m {
            font-size: 14px;
            font-weight: bold;
        }

        .m1 {
            font-size: 14px;
            font-weight: bold;
            text-align: center;
        }

         .mr {
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            color: #ff0000;
        }

        .red {
            color: #ff0000;
        }

        .btn {
            width: 65px;
            padding: 4px;
            background-color: #428bca;
            border-color: #357ebd;
            color: #fff;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            border-radius: 5px; /* future proofing */
            -khtml-border-radius: 5px; /* for old Konqueror browsers */
            text-align: center;
            vertical-align: middle;
            border: 1px solid transparent;
            font-weight: 400;
            font-size: 120%;
        }
        .btn_1 {
            width: 50px;
            padding: 4px;
            background-color: #428bca;
            border-color: #357ebd;
            color: #fff;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            border-radius: 5px; /* future proofing */
            -khtml-border-radius: 5px; /* for old Konqueror browsers */
            text-align: center;
            vertical-align: middle;
            border: 1px solid transparent;
            font-weight: 400;
            font-size: 120%;
        }
    </style>
}


<div class="main" style="margin-bottom: 110px;">

    <div class="top">
        <div class='small'>
            <p class="smallcontent1" id="lefttimer0">距离团购成功还剩</p>
            <p class="smallcontent2" id="lefttimer"></p>
        </div>
    </div>
    <div class="listsBox" style="margin: 10px;">
        <ul class="nospace clearfix">
            <li class="m1">
                <span class="m1">欢迎 @Model.UserName (@Model.UserId)加入云联家园</span>
            </li>
            <li>
                <span class="m">今日日期：@Model.TodayTime</span>
            </li>
            <li>
                <span class="m">团购日期：@ViewBag.OrderTime</span>
            </li>
            <li>
                <span class="m">团购订单号：@Model.GPNo</span>
            </li>
            <li>
                <span class="m">用户级别：@Model.Grade </span> 
                
                @if (!string.IsNullOrEmpty(Model.PackageRemark))
                {
                    <span class="mr"> (套)</span>
                 }
                    
            </li>
            <!--
            <li>
                <span class="m">云联惠ID：@Model.YlUserId</span>
            </li>
            -->
            <li>
               
                    <span class="m">
                        用户状态：@Model.Status  @Model.ReceiveType
                    </span>
                    @if (Model.Status == "团购成功")
                    {
                        <input class="btn" type="button" id="btn"
                               value="领取奖励" onclick="location.href='/Member/ChooseReward'" style="font-size: 14px;color:#FFF;" />
                    }
               
            </li>
            <li>
                <form action="/Member/GetDirectBus" method="post">
                    <span class="m">直通车：总人数 <span class="red">@Model.DirectBusCount</span> 已领取 <span class="red">@(Model.DirectBusCount1 * 25)</span> 未领取 <span class="red">@(Model.DirectBusCount - Model.DirectBusCount1 * 25)</span> </span>
                    @if (Model.DirectBusCount / 25 - Model.DirectBusCount1 > 0)
                    {
                        
                        <input class="btn" type="submit" id="btn"
                               value="领 取" style="font-size: 14px;color:#FFF;" />
                    }
                </form>
            </li>

        </ul>
    </div>
    <div style="margin: 10px;">
        <!--
        <input type="submit" class="buttonWrap button button-green buttonLong" onclick="javascript: location.href = '/Member/MyQrcode'" value="生成推广二维码">
         -->
    </div>
</div>


@section scripts
{
    <script language="javascript" type="text/javascript">

        function leftTimer(year, month, day, hour, minute, second) {
            if (year == 1900) {
                document.getElementById("lefttimer0").innerHTML = "";
                document.getElementById("lefttimer").innerHTML = "尚未团购";
                return;
            }
            var leftTime = (new Date(year, month - 1, day, hour, minute, second)) - (new Date()); //计算剩余的毫秒数
            var days = parseInt(leftTime / 1000 / 60 / 60 / 24, 10); //计算剩余的天数


            var hours = parseInt(leftTime / 1000 / 60 / 60 % 24, 10); //计算剩余的小时
            var minutes = parseInt(leftTime / 1000 / 60 % 60, 10);//计算剩余的分钟
            var seconds = parseInt(leftTime / 1000 % 60, 10);//计算剩余的秒数

            days = checkTime(days);
            hours = checkTime(hours);
            minutes = checkTime(minutes);
            seconds = checkTime(seconds);

            if (days < 0) {
                document.getElementById("lefttimer").innerHTML = "已到期";
            } else {
                document.getElementById("lefttimer").innerHTML = days + "天" + hours + "小时" + minutes + "分" + seconds + "秒";
            }

        }
        function checkTime(i) { //将0-9的数字前面加上0，例1变为01
            if (i < 10) {
                i = "0" + i;
            }
            return i;
        }

        $(document).ready(function () {
            var status = '@Model.Status';
            if (status == "团购成功" || status == "等待发放" || status == "发放完成" )
            {
                document.getElementById("lefttimer0").innerHTML = "恭喜你，团购成功啦！";
                document.getElementById("lefttimer").innerHTML = ""
            }
            else if(status=="尚未团购")
            {
                document.getElementById("lefttimer0").innerHTML = "尚未团购";
                document.getElementById("lefttimer").innerHTML = "";
            }
            else {
                setInterval("leftTimer(@Model.OrderTime.Value.Year,@Model.OrderTime.Value.Month,@Model.OrderTime.Value.Day,@Model.OrderTime.Value.Hour,@Model.OrderTime.Value.Minute,@Model.OrderTime.Value.Second)", 1000)
            }
        })

    </script>
}
